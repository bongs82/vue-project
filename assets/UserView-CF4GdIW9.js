import{_ as U,r,b as A,c as o,a as s,w as k,d as b,v as M,n as D,t as i,F as V,e as E,g as B,f as C,h as P,i as L,j as F,s as q,k as $,o as t}from"./index-DNdrKBkE.js";import{h as R}from"./crypto-DZhsZgwG.js";const S={class:"user"},W={class:"form-section"},T={class:"input-group"},j={key:0,class:"error-text"},z={key:1,class:"error-text"},H={key:0,class:"error-text"},G={key:0,class:"error-text"},J={key:0,class:"error-text"},K={key:0},O={key:1,class:"error"},Q={key:2},X={class:"collection-section"},Y={key:0},Z={key:1},ee={class:"collection-section"},le={key:0},se={key:1},oe={__name:"UserView",setup(te){const w=r([]),y=r([]),x=r(!0),_=r(null),n=r(""),d=r(""),v=r(""),c=r(""),I=async()=>{x.value=!0,w.value=[],y.value=[],_.value=null;try{console.log("Fetching ALL documents from 'items' collection...");const a=await B(C(P,"items"));a.empty?console.log("Collection 'items' is empty."):a.forEach(u=>{console.log("Item:",u.id," => ",u.data()),w.value.push({id:u.id,...u.data()})}),console.log("Fetching 'member/user' document...");const e=L(P,"member","user"),l=await F(e);if(l.exists()){const u=l.data();console.log("Member Data:",u),u.userList&&Array.isArray(u.userList)?y.value=u.userList:console.log("'userList' field is missing or not an array.")}else console.log("Document 'member/user' does not exist.")}catch(a){console.error("Error fetching documents:",a),_.value="Error fetching documents: "+a.message}finally{x.value=!1}},m=r(!0),g=r(!0),p=r(!0),h=r(!0),f=r(!1),N=async()=>{if(f.value=y.value.some(a=>a.id===n.value),console.log(n.value,d.value,v.value,c.value),m.value=n.value.length>0,g.value=d.value.length>0,p.value=v.value.length>0,h.value=c.value.length>0,!m.value||!g.value||!p.value||!h.value)return console.log("value error");if(f.value)return console.log("id error");f.value=!1,console.log("Attempting to add member:",n.value);try{console.log("Writing to doc: member/user with arrayUnion");const a=await R(d.value),e={id:n.value,password:a,name:v.value,phone:c.value};await q(L(P,"member","user"),{userList:$(e)},{merge:!0}),console.log("Write successful"),n.value="",d.value="",v.value="",c.value="",m.value=!0,g.value=!0,p.value=!0,h.value=!0,console.log("Refreshing data..."),await I()}catch(a){console.error("Error adding member:",a),alert("Error adding member: "+a.message)}};return A(()=>{I()}),(a,e)=>(t(),o("div",S,[e[10]||(e[10]=s("h1",null,"Firebase Connection Test",-1)),s("div",W,[e[8]||(e[8]=s("h2",null,"Add New Member",-1)),s("div",T,[s("div",null,[k(s("input",{"onUpdate:modelValue":e[0]||(e[0]=l=>n.value=l),onBlur:e[1]||(e[1]=l=>(m.value=n.value.length>0,f.value=!1)),class:D({error:!m.value||f.value}),placeholder:"Enter ID"},null,34),[[M,n.value]]),m.value?b("",!0):(t(),o("p",j,"ID is required")),f.value?(t(),o("p",z,"ID already exists")):b("",!0)]),s("div",null,[k(s("input",{"onUpdate:modelValue":e[2]||(e[2]=l=>d.value=l),onBlur:e[3]||(e[3]=l=>g.value=d.value.length>0),type:"password",class:D({error:!g.value}),placeholder:"Enter Password"},null,34),[[M,d.value]]),g.value?b("",!0):(t(),o("p",H,"Password is required"))]),s("div",null,[k(s("input",{"onUpdate:modelValue":e[4]||(e[4]=l=>v.value=l),onBlur:e[5]||(e[5]=l=>p.value=v.value.length>0),class:D({error:!p.value}),placeholder:"Enter Name"},null,34),[[M,v.value]]),p.value?b("",!0):(t(),o("p",G,"Name is required"))]),s("div",null,[k(s("input",{"onUpdate:modelValue":e[6]||(e[6]=l=>c.value=l),onBlur:e[7]||(e[7]=l=>h.value=c.value.length>0),class:D({error:!h.value}),placeholder:"Enter Phone"},null,34),[[M,c.value]]),h.value?b("",!0):(t(),o("p",J,"Phone is required"))]),s("button",{onClick:N},"Add Member")])]),s("button",{onClick:I,class:"refresh-btn"},"Refresh Data"),x.value?(t(),o("div",K,"Loading data...")):_.value?(t(),o("div",O,i(_.value),1)):(t(),o("div",Q,[s("div",X,[s("h2",null,"Items Collection ("+i(w.value.length)+")",1),w.value.length>0?(t(),o("ul",Y,[(t(!0),o(V,null,E(w.value,l=>(t(),o("li",{key:l.id},[s("strong",null,"ID: "+i(l.id),1),s("pre",null,i(l),1)]))),128))])):(t(),o("p",Z,"No items found."))]),s("div",ee,[e[9]||(e[9]=s("h2",null,"Member List (from member/user)",-1)),y.value.length>0?(t(),o("ul",le,[(t(!0),o(V,null,E(y.value,l=>(t(),o("li",{key:l.id},[s("strong",null,"ID: "+i(l.id),1),s("span",null," / Name: "+i(l.name),1),s("span",null," / Phone: "+i(l.phone),1),s("span",null," / PW (Hash): "+i(l.password),1)]))),128))])):(t(),o("p",se,"No members found."))])]))]))}},ne=U(oe,[["__scopeId","data-v-f9cffa7c"]]);export{ne as default};
